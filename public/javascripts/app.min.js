angular.module("app",["app.tpl","ngSanitize","ngRoute","ngCookies","ngAnimate","ui.select","ui.bootstrap","main","pattern"]).constant("API_URL","/api/v1/").config(["$httpProvider","$locationProvider",function(e,t){t.html5Mode({enabled:!0,requireBase:!1})}]).run(["$http","$cookieStore","$log","$window",function(e,t,n,r){e.post("/api/v1/access_token",{grant_type:"client_credentials",client_id:r.Conf.clientId}).then(function(e){t.put("access_token",e.data.access_token)},function(e){n.error(e)})}]).run(["$injector","$cookieStore",function(e,t){e.get("$http").defaults.transformRequest=function(e,n){var r=t.get("access_token");r&&(n().Authorization="Bearer "+r)}}]),angular.module("main.controllers",[]).controller("IndexCtrl",["$scope","$location","$log","$timeout","$templateCache","$modal","DrugService","DrugsList","API_URL",function(e,t,n,r,a,o,i,l,u){function s(){e.followedDrugs=_.map(l.all(),function(e){return{name:e,following:!0}}),_.forEach(e.followedDrugs,function(e){i.getDrugByName(e.name).then(function(t){e.details=t})})}e.endpoint=u+"drugs",e.drug={},i.getTypeaheadDrugs().then(function(t){e.drugs=_.sortBy(t)}),s(),e.supplemental="/assets/main/partials/why.html",e.highlightClass=function(e){return e.details?e.details.recalls?"drug-status-recall":e.details.labelChanges?"drug-status-label":"drug-status-ok":"drug-status-loading"},e.highlightSelected=function(t){return e.drug&&e.drug.name===t.name?"selected":void 0},e.removeDrug=function(t){l.remove(t.name),e.followedDrugs=_.reject(e.followedDrugs,{name:t.name})},e.addDrug=function(t){l.add(t.name),e.followedDrugs.push(t)},e.manuallySelectDrug=function(t){e.drug=t},e.clearDrugDetails=function(){e.drug&&(delete e.drug.details,delete e.drug.following)},e.updateSupplemental=function(t){e.drug={},e.supplemental="/assets/main/partials/"+t+".html"},e.$on("subscription-change",function(t,n){e[n.action+"Drug"](n.drug)})}]),angular.module("main.directives",[]).directive("drugSummary",function(){var e=function(e,t){function n(e,n){var r="";if(!e||!e.details)return r;if("recall"===n&&e.details.recalls){var a=e.details.recallDetails.length;1===a?r+="There is an open recall on "+e.name:a>1&&(r+="There are "+a+" open recalls on "+e.name)}return"label"===n&&e.details.labelChanges&&(r+="Label was last changed on "+t("fdaDate")(_.first(e.details.labelDetails).effective_time)),r}e.$watch("drug",function(t){e.description=n(t,e.type)},!0)};return e.$inject=["$scope","$filter"],{restrict:"A",template:"{{description}}",scope:{drug:"=",type:"="},controller:e}}).directive("drugDetail",function(){var e=function(e,t,n,r,a){e.toggleFollow=function(){var t=e.drug.following?"remove":"add";r.$broadcast("subscription-change",{action:t,drug:e.drug}),e.drug.following=!e.drug.following},e.interactionPairConcepts=function(e){return _(e.interactionConcept).map(function(e){return e.minConceptItem.name}).join(", ")},e.showInteractionDetails=function(){return!e.drug||!e.drug.details||!_.isEmpty(e.drug.details.interactionDetails)},e.done=function(){e.drug={}},e.$watch("drug",function(r){e.drug&&e.drug.name&&(a(),e.drug.following=_.includes(n.all(),e.drug.name),e.drug.name&&!e.drug.details&&t.getDrugByName(e.drug.name).then(function(t){e.drug.details=t}))},!0)};return e.$inject=["$scope","DrugService","DrugsList","$rootScope","$anchorScroll"],{restrict:"A",templateUrl:"/assets/main/partials/drug-details.html",controller:e}}),angular.module("main.filters",[]).filter("encodeURIComponent",function(){return window.encodeURIComponent}).filter("fdaDate",["$filter",function(e){return function(t){var n=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8);return e("date")(n)}}]),angular.module("main",["main.controllers","main.directives","main.routes","main.services","main.filters"]),angular.module("main.routes",[]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"assets/main/partials/main-index.html",controller:"IndexCtrl"}).when("/drugdetail",{templateUrl:"assets/main/partials/drug-detail.html",controller:"DrugDetailsCtrl"})}]),function(){angular.module("main.services",[]).factory("DrugService",["API_URL","$http","$q","$log",function(e,t,n,r){return{getTypeaheadDrugs:function(){var e=n.defer();return t({url:"/assets/datasets/meds.json"}).success(function(t){e.resolve(t)}).error(function(){e.reject("Problem retrieving drug names for typeahead")}),e.promise},getDrugs:function(r){var a=n.defer(),o={method:"GET",url:e};return r&&(o.params.query=r),t(o).success(function(e){a.resolve(e)}).error(function(e){a.reject("Problem retrieving medicines: "+e)}),a.promise},getDrugByName:function(n){return t.get(e+"drugs/"+n).then(function(e){return e.data},function(e){r.error(e)})}}}]).factory("DrugsList",function(){return{all:function(){var e=window.localStorage.drugslist;return e?angular.fromJson(e):[]},save:function(e){window.localStorage.drugslist=angular.toJson(e)},add:function(e){var t=this.all();~t.indexOf(e)||t.push(e),this.save(t)},remove:function(e){var t=this.all(),n=t.indexOf(e);~n&&(t.splice(n,1),this.save(t))}}})}(),angular.module("pattern.controllers",[]).controller("PatternCtrl",["$scope",function(e){e.options=[{name:"Abilify"},{name:"Namenda"},{name:"Viagra"},{name:"Zetia"},{name:"Cialis"},{name:"Nasonex"}]}]),angular.module("pattern",["pattern.controllers","pattern.routes"]),angular.module("pattern.routes",[]).config(["$routeProvider",function(e){e.when("/pattern",{templateUrl:"assets/pattern/partials/main.html",controller:"PatternCtrl"})}]),describe("Working Unit Tests",function(){beforeEach(module("app")),it("is running tests",function(){var e=!0;expect(e).toBe(!0)})});